# 분류(classification)-로지스틱 회귀

생성일: 2023년 3월 21일 오전 9:20

# 1. 이진 분류 (Binary Classfication)

- 이진 분류는 예측값이 0또는 1 두 가지로 제한된 분류이다.
- 입력 데이터를 두 개의 클래스 중 하나에 배정해야하는 문제를 이진 분류 문제라고 한다.
    - 이메일을 스팸 메일과 정상 메일로 분류하는 문제, 질병이 있는지 없는지 진단하는 문제, 이미지를 고양이와 개로 분류하는 문제 등이 해당한다.

## 1-1) 이진 혼동 행렬(Binary Confusion Matrix)

- 이진 분류 모델의 정확도를 평하기 위해 사용하는 도구
- 실제값과 예측값 간의 비교를 통해 정확도를 계산한다.
- 통상적으로 알고 싶은 것을 Positive, 그 반대를 Negative
    - 제품을 제조할 때 정상 제품과 불량 제품 중 주로 불량제품의 수를 알고 싶어하고 이 때 불량 제품을 Positive라고 설정한다.
- 4가지 요소를 구성된다
    - True Positive(TP) : 실제 값 1 이고 예측도 1인 경우
    - True Negative(TN) : 실제 0이고 예측도 0인 경우
    - False Positive(FP) : 실제 0이지만 예측은 1인 경우
    - False Negative(FN) : 실제 1이지만 예측은 0인 경우
- 정확도(Accuracy)
    - 정확도는 예측값과 실제값이 일치하는 비율을 의미합니다.
    - $Accuracy= \frac{(TP + TN)}{(TP + FP + FN + TN)}$
- 정밀도(Precision)
    - 정밀도는 실제 값 1로 분류된 것 중 예측값이 1인 것의 비율
        - $Precision = \frac{TP}{TP + FP}$
- 재현율(Recall)
    - 재현율(Recall) : 실제 값 1인 것 중 예측도 1로 맞춘 것의 비율
        - $Recall = \frac{TP}{TP + FN}$
- F1 - score
    - 정확도(Accuracy), 정밀도(Precision), 재현율(Recall)을 계산하고, 이를 바탕으로 F1 score를 계산합니다.
    - 정밀도(Precision)와 재현율(Recall)의 조화평균(harmonic mean)으로 정의됩니다.
        - $F1 = 2 \times \frac{Precision \times Recall}{Precision + Recall}$
        
        - **조화평균**
            - 2개 이상의 숫자의 평균을 구할 때 그 숫자들의 역수의 합의 역수로 나누어 구하는 평균을 말한다.
            - 평균값에 더 가까운 중앙값을 구할 수 있기 때문에 평균값이 동일한 여러 숫자들 중 일부 숫자가 다른 숫자들과 크게 다른 값을 가지고 있는 집단에서 더 안정적인 중심값을 구할 때 사용

# 2. 로지스틱 회귀(Logistic Regression)

- 로지스틱 회귀는 이항 분류 모델링을 위한 대표적인 기법이다
- 0과 1, 참과 거짓, 양성과 음성 등 2가지 클래스를 분류하는 문제를 해결하는데 사용된다.
- 로지스틱 회귀는 선형 회귀와 비슷하지만, 출력이 확률 값으로 제한된다는 것이 차이다.
- S 자형 함수인 시그모이드 함수를 사용하여 회귀식으로 출력값을 0과 1사이의 확률로 변환한다. 이 확률값은 각 클래스에 대한 입력 데이터의 조건부 확률로 나타낸다.
- 로지스틱 회귀는 다음과 같은 수식으로 표기한다.
    - $P(Y=1|X) = σ(β0 + β1X1 + β2X2 + ... + βnXn)$
    - $P(Y=1|X)$는 입력 변수 X를 가지고 $Y=1$이라는 이벤트가 발생할 확률을 나타낸다
    - σ는 시그모이드 함수를 나타내고, β0은 회귀식의 상수항을 나타낸다,
    - β1 ~ βn은 입력 변수 X1 ~ Xn의 계수를 나타낸다.

### 2 - 1) 시그모이드(sigmoid) 함수

- 입력값에 대해 0과 1사이의 값을 반환한다.
- 입렵값이 크기가 커짐에 따라 성장속도가 둔화되는 특징이 있다.
- 입력값에 대해 0과 1사이의 값을 반환하는 S자형 함수
- 출력값이 0과 1 사이에 수렴하는 효과가 있다
- 수식은 다음과 같이 정의된다.
    - 분수로 바꿔줘
        
        $σ(z) = \frac{1}{1 + e^{-z}}$
        
    - z는 실수 값으로 시그모이드 함수의 입력값을 나타낸다.
    - 함수의 출력값은 확률값으로 해석되는데,  0.5를 기준으로 0.5보다 작으면 0에 가까운 값으로, 0.5보다 크면 1에 가까운 값으로 해석한다.